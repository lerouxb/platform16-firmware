
#ifndef PLATFORM_RHYTHMS_H
#define PLATFORM_RHYTHMS_H

#include <vector>

namespace platform {

std::vector<std::vector<bool>> euclideanRhythms{// none
                                                {0},

                                                // every time
                                                {1},

                                                // k=1, n=2
                                                {1, 0},

                                                // k=1, n=3
                                                {1, 0, 0},
                                                // k=2, n=3
                                                {1, 0, 1},

                                                // k=1, n=4
                                                {1, 0, 0, 0},
                                                // k=3, n=4
                                                {1, 0, 1, 1},

                                                // k=1, n=5
                                                {1, 0, 0, 0, 0},
                                                // k=2, n=5
                                                {1, 0, 1, 0, 0},
                                                // k=3, n=5
                                                {1, 0, 1, 0, 1},
                                                // k=4, n=5
                                                {1, 0, 1, 1, 1},

                                                // k=1, n=6
                                                {1, 0, 0, 0, 0, 0},
                                                // k=5, n=6
                                                {1, 0, 1, 1, 1, 1},

                                                // k=1, n=7
                                                {1, 0, 0, 0, 0, 0, 0},
                                                // k=2, n=7
                                                {1, 0, 0, 1, 0, 0, 0},
                                                // k=3, n=7
                                                {1, 0, 1, 0, 1, 0, 0},
                                                // k=4, n=7
                                                {1, 0, 1, 0, 1, 0, 1},
                                                // k=5, n=7
                                                {1, 0, 1, 1, 0, 1, 1},
                                                // k=6, n=7
                                                {1, 0, 1, 1, 1, 1, 1},
                                                
                                                // k=1, n=8
                                                {1, 0, 0, 0, 0, 0, 0, 0},
                                                // k=3, n=8
                                                {1, 0, 0, 1, 0, 0, 1, 0},
                                                // k=5, n=8
                                                {1, 0, 1, 1, 0, 1, 1, 0},
                                                // k=7, n=8
                                                {1, 0, 1, 1, 1, 1, 1, 1},

                                                // k=1, n=9
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=2, n=9
                                                {1, 0, 0, 0, 1, 0, 0, 0, 0},
                                                // k=4, n=9
                                                {1, 0, 1, 0, 1, 0, 1, 0, 0},
                                                // k=5, n=9
                                                {1, 0, 1, 0, 1, 0, 1, 0, 1},
                                                // k=7, n=9
                                                {1, 0, 1, 1, 1, 0, 1, 1, 1},
                                                // k=8, n=9
                                                {1, 0, 1, 1, 1, 1, 1, 1, 1},

                                                // maybe after this it gets too much?

                                                // k=1, n=10
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=3, n=10
                                                {1, 0, 0, 1, 0, 0, 1, 0, 0, 0},
                                                // k=7, n=10
                                                {1, 0, 1, 1, 0, 1, 1, 0, 1, 1},
                                                // k=9, n=10
                                                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1},

                                                // k=1, n=11
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=2, n=11
                                                {1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
                                                // k=3, n=11
                                                {1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0},
                                                // k=4, n=11
                                                {1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0},
                                                // k=5, n=11
                                                {1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0},
                                                // k=6, n=11
                                                {1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},
                                                // k=7, n=11
                                                {1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0},
                                                // k=8, n=11
                                                {1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1},
                                                // k=9, n=11
                                                {1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1},
                                                // k=10, n=11
                                                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1},

                                                // k=1, n=12
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=5, n=12
                                                {1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0},
                                                // k=7, n=12
                                                {1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0},
                                                // k=11, n=12
                                                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},

                                                // k=1, n=13
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=2, n=13
                                                {1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
                                                // k=3, n=13
                                                {1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0},
                                                // k=4, n=13
                                                {1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0},
                                                // k=5, n=13
                                                {1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0},
                                                // k=6, n=13
                                                {1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0},
                                                // k=7, n=13
                                                {1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},
                                                // k=8, n=13
                                                {1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1},
                                                // k=9, n=13
                                                {1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1},
                                                // k=10, n=13
                                                {1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1},
                                                // k=11, n=13
                                                {1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1},
                                                // k=12, n=13

                                                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
                                                // k=1, n=14
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=3, n=14
                                                {1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0},
                                                // k=5, n=14
                                                {1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0},
                                                // k=9, n=14
                                                {1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0},
                                                // k=11, n=14
                                                {1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1},
                                                // k=13, n=14
                                                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},

                                                // k=1, n=15
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=2, n=15
                                                {1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
                                                // k=4, n=15
                                                {1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0},
                                                // k=7, n=15
                                                {1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0},
                                                // k=8, n=15
                                                {1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},
                                                // k=11, n=15
                                                {1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1},
                                                // k=13, n=15
                                                {1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1},
                                                // k=14, n=15

                                                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
                                                // k=1, n=16
                                                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                                // k=3, n=16
                                                {1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
                                                // k=5, n=16
                                                {1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0},
                                                // k=7, n=16
                                                {1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0},
                                                // k=9, n=16
                                                {1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0},
                                                // k=11, n=16
                                                {1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1},
                                                // k=13, n=16
                                                {1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1},
                                                // k=15, n=16
                                                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}};

struct Rhythm {
  Rhythm() : rhythm(&euclideanRhythms[0]), nextStep(0), lastValue{0} {}

  void setRhythm(std::vector<bool>* newRhythm) {
    rhythm = newRhythm;
  }

  float getLastValue() const {
    return lastValue;
  }

  bool process() {
    // Check if nextStep is beyond the current rhythm's size
    if (nextStep >= rhythm->size()) {
      nextStep = 0;
    }

    bool result = (*rhythm)[nextStep];
    nextStep++;

    // Reset to 0 if we've reached the end
    if (nextStep >= rhythm->size()) {
      nextStep = 0;
    }

    lastValue = result;
    return result;
  }

  private:
  std::vector<bool>* rhythm;
  size_t nextStep;
  float lastValue;
};

}  // namespace platform

#endif  // PLATFORM_RHYTHMS_H
